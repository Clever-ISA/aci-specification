# ACI Specification Software Interface

This Specification Describes the interface that a software written to inteface with devices accessible to ACI.

## No Requirement to Implement

A Hardware Vendor that implements the ACI Host Specification is not required to provide this interface to communicate with devices accessible via the ACI Bus.

Compliance with this specification is deemed separate from complaince with the ACI Host Specification.

## DMA Space 

The DMA Space refers to a region of memory reserved by the CPU, which is used to access ACI Devices directly.

The DMA Space is 0x20000000 (2^29) bytes large, but a CPU may specify a smaller power of 2 size if it supports fewer device id assignments.  If the CPU specifies a smaller size, it should provide a mechanism to query the size of this space. The implementation vendor should document this mechanism.

The DMA Space is aligned to its size.

Accesses to this DMA Space have a base address, which is aligned to at the alignment of the DMA Space. The default base address, and whether one is assigned by default, is unspecified. The CPU should provide a mechanism to query and modify the base address. The implementation vendor should document this mechanism.

When accessing memory in this region, the lower 29 (or fewer, as specified above) bits of the address are considered. 

The top 16 bits of the address form the device id, for which device to access. The next 12 bits form the DMA Address. The remaining 3 bits are reserved and should be zero, expect as documented below.

## DMA Accesses

An access made into the DMA space performs a DMA transfer - reads perform a DMA Read, and writes perform a DMA Write. The access must be 4 byte aligned and 4 bytes in size. Except as documented below, any other accesses to this space have an undefined result.

The Device ID and the DMA Address are computed as in [DMA Space](#dma-space). 

CPUs should detect repeated accesses of the same type to the same or to incrementing consecutive addresses and fold them into a single transfer operation if possible. The mechanism of communicating repeating or consecutive accesses to the CPU is CPU specific. 